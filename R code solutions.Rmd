---
title: "OKISAMEN AZIEGBEMI -HomeWork1 R Code"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
# import libraries

library(tidyverse)
library(ggplot2)
library(psych)

```


```{r}
# Import dataset

cat = read_csv(file.choose())
cat
```

# Question 1A: Linear Regression Estimation 
```{r}

fit.cat = lm(formula = heart  ~ body, 
             data    = cat)

fit.cat

```


# Question 1B: Scatter Plot 
```{r}
ggplot(data = cat,
       aes(x = body, y = heart)) + 
  geom_point() + 
  geom_smooth(method = 'lm', se = F) +
  labs(x = "Body weight of Cat",
       y = "Heart weight of Cat",
       title = " Heart weight vs. Body weight of cats ")


```


# Question 1C: Residual with the third observation
```{r}

resid(object = fit.cat)


```

```{r}
# OR

resid(fit.cat)[3]
```


# Question 1D: Estimate for the Variance
```{r}

# get the residuals and square them
residuals = resid(object = fit.cat)

# square the residuals
residuals_squared = residuals^2

# check the residuals
residuals_squared
```
```{r}
# sum the squared-residuals

res = 0.54081722 + 0.12828694 + 0.50226579 + 4.66695450 + 0.01747419 + 6.97925698 + 0.17233516 + 0.17411806 + 0.96574929 + 0.83159793 + 0.41057006 + 0.02604494 

# divide by the degrees of freedom (df = n - 2 = 12- 2 = 10)
res/10

# point estimator of sigma^2 is 1.541547



# OR using the formula directly
sum(resid(fit.cat)^2) / (10)
```

# Question 1E: 95% Confidence interval
```{r}

confint(fit.cat)
```


# Question 1F: Using 5% significant level...
```{r}
# To see details of our model
summary(fit.cat)

### Hypotheses
# H_0: B_1 = 0
# H_1: B_1 > 0


### test statistics (t)
t = 8.408


### p-value
p_value = 1 - pt(t, 10)
p_value

```


# Question 1G: Obtain a point estimate and a 99% confidence interval...
```{r}
newdata = tibble(body = c( 2.5 ))

predict( object = fit.cat,
         new = newdata,
         interval = "c",    # confidence interval
         level = 0.99)

#?predict()

#confint(fit.cat, level = )

```





# Question 1H: Obtain a point estimate and a 99% prediction interval...
```{r}
newdata = tibble(body = c( 3.0 ))
predict( object = fit.cat,
         new = newdata,
         interval = "p",    # prediction interval
         level = 0.99)

```


# Question 2e: The file q2.csv contains... Find the maximum liklihood estimators
```{r}
q2 = read_csv(file.choose())
q2
```


```{r}
# for B_1
B_1 = sum(q2$x * q2$y) / sum( (q2$x)^2)
B_1

# for sigma^2
n = nrow(q2)
n

sigma.2 = sum( (q2$y - (B_1*q2$x) )^2 ) / n
sigma.2

```

















































































































































































































































































































































































































































































